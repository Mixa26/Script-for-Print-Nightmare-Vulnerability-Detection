# What is print nighmare, and how it can be used?
Print nighmare was a Windows OS vulnerability that was patched in August-September 2021.<br>
A program RPCAddPrinterdriver in windows was a vulnerability, and the Printer Spooler service.<br>
It allowed any authenticated(not authorized as well) users to remotely add "printer drivers" to the system.<br>
There are a couple of exploits out there like creating a fake printer and having the target connect to it,<br>
downloading a malicious driver and making the attacker escalate privilege.

![pic1](pics/Immagine.jpg)

Or having a real printer and doing a similar job.

![pic2](pics/Immagine1.jpg)

Pictures taken from: https://itm4n.github.io/printnightmare-exploitation/

# So how does this script check for the attack?
Dont take this as a 100% check for your PC being safe. It check if you have a Windows patch that<br>
covers this problem installed, if not it checks if the Spooler service is running on your PC.

![pic3](pics/Immagine2.jpg)

If it is, then it checks if registry keys are present like:

```code
HKLM:\SOFTWARE\Policies\Microsoft\Windows", "NT\Printers\PointAndPrint
```

if it is then it checks for NoWarningNoElevationOnInstall and UpdatePromptSettings are set to True.
